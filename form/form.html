<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags-->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <meta name="keywords" content="" />

    <!-- Title Page-->
    <title>Avenue | garden</title>

    <!-- Icons font CSS-->
    <link
      href="vendor/mdi-font/css/material-design-iconic-font.min.css"
      rel="stylesheet"
      media="all"
    />
    <link
      href="vendor/font-awesome-4.7/css/font-awesome.min.css"
      rel="stylesheet"
      media="all"
    />
    <!-- Font special for pages-->
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet"
    />

    <!-- Vendor CSS-->
    <link
      href="vendor/select2/select2.min.css"
      rel="stylesheet"
      media="all"
    />
    <link
      href="vendor/datepicker/daterangepicker.css"
      rel="stylesheet"
      media="all"
    />

    <!-- Main CSS-->
    <link
      href="css/main.css"
      rel="stylesheet"
      media="all"
    />

    <style>
      .highlight a {
        color: red !important;
        pointer-events: none;
        cursor: not-allowed;
      }
    </style>
  </head>

  <body>
    <div
      class="
        page-wrapper
        bg-gra-02
        p-t-130 p-b-100
        font-poppins
      "
    >
      <div class="wrapper wrapper--w680">
        <div class="card card-4">
          <div class="card-body">
            <h2 class="title">Book Here</h2>
            <form method="POST">
              <div class="row row-space">
                <div class="col-2">
                  <div class="input-group">
                    <label class="label"> First Name</label>
                    <input
                      class="input--style-4"
                      type="text"
                      name="first_name"
                    />
                  </div>
                </div>
                <div class="col-2">
                  <div class="input-group">
                    <label class="label"> Last Name</label>
                    <input
                      class="input--style-4"
                      type="text"
                      name="first_name"
                    />
                  </div>
                </div>
                <div class="col-2">
                  <div class="input-group">
                    <label class="label">email</label>
                    <input
                      class="input--style-4"
                      type="email"
                      name="email"
                    />
                  </div>
                </div>
                <div class="col-2">
                  <div class="input-group">
                    <label class="label">Phone</label>
                    <input
                      class="input--style-4"
                      type="phone"
                      name="phone"
                    />
                  </div>
                </div>
              </div>
              <div class="row row-space">
                <div class="col-2">
                  <div class="input-group">
                    <label class="label">Check In</label>
                    <div class="input-group-icon">
                      <input
                        class="input--style-4 js-datepicker"
                        id="startdate"
                        type="text"
                        name="Check in"
                      />
                      <i
                        class="
                          zmdi zmdi-calendar-note
                          input-icon
                        "
                        style="cursor: default"
                      ></i>
                    </div>
                  </div>
                </div>
                <div class="col-2">
                  <div class="input-group">
                    <label class="label">Check Out</label>
                    <div class="input-group-icon">
                      <input
                        class="input--style-4 js-datepicker"
                        id="enddate"
                        type="text"
                        name="Check out"
                      />
                      <i
                        class="
                          zmdi zmdi-calendar-note
                          input-icon
                        "
                        style="cursor: default"
                      ></i>
                    </div>
                  </div>
                </div>
                <div class="col-3">
                  <div class="input-group">
                    <label class="label">Slot</label>
                    <div class="p-t-10">
                      <label class="radio-container ok"
                        >Day
                        <input
                          type="radio"
                          checked="checked"
                          name="gender"
                        />
                        <span class="checkmark"></span>
                      </label>
                      <label class="radio-container ok"
                        >Night
                        <input type="radio" name="gender" />
                        <span class="checkmark"></span>
                      </label>
                      <label class="radio-container"
                        >Both
                        <input type="radio" name="gender" />
                        <span class="checkmark"></span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="p-t-15">
                <button
                  class="btn btn--radius-2 btn--blue"
                  type="submit"
                >
                  Book Now
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Jquery JS-->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <link
      rel="stylesheet"
      href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"
    />
    <script>
      // $.ajax({
      //   url: '/getbookeddates',
      //   type: 'GET',
      //   contentType: false,
      //   dataType: 'text',
      //   success: function (response) {
      //     let array = response.split(',');
      //     task(array);
      //   },
      // });
      var dateString = '2021-05-20,2021-05-25';
      let array = dateString.split(',');
      task(array);

      function task(array) {
        $('#startdate').datepicker({
          dateFormat: 'yy-mm-dd',
          minDate: 0,
          beforeShowDay: function (date) {
            var string = jQuery.datepicker.formatDate(
              'yy-mm-dd',
              date
            );
            if (array.indexOf(string) == -1) {
              return [true];
            } else {
              return [
                true,
                'highlight ui-datepicker-unselectable',
                'Hall Booked',
              ];
            }
          },
        });

        $('#enddate').datepicker({
          dateFormat: 'yy-mm-dd',
          minDate: 0,
          beforeShowDay: function (date) {
            var string = jQuery.datepicker.formatDate(
              'yy-mm-dd',
              date
            );
            if (array.indexOf(string) == -1) {
              return [true];
            } else {
              return [
                true,
                'highlight ui-datepicker-unselectable',
                'Hall Booked',
              ];
            }
          },
        });
      }

      $(document).ready(function () {
        $('#form').submit(function (event) {
          event.preventDefault();
          var formData = {
            fname: $('#fname').val(),
            lname: $('#lname').val(),
            unique_id: $('#unique_id').val(),
            startdate: $('#startdate').val(),
            enddate: $('#enddate').val(),
          };
          $.ajax({
            url: '/bookhall',
            type: 'POST',
            enctype: 'multipart/form-data',
            data: JSON.stringify(formData),
            contentType: false,
            dataType: 'text',
            cache: false,
            processData: false,
            success: function (response) {
              if (response == 'Booked') {
                document.getElementById('fname').value = '';
                document.getElementById('lname').value = '';
                document.getElementById('unique_id').value =
                  '';
                document.getElementById('startdate').value =
                  '';
                document.getElementById('enddate').value =
                  '';
              }
              alert(response);
            },
          });
        });
      });
    </script>
  </body>
</html>
<!-- end document-->
